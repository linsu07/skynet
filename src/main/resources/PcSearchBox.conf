include "reference.conf"
app_name = "pcsearchbox 2.6.x antispam"
local=false

rules_group = [
  feature_group
  guid_group
  srcg_guid_group
  srcg_group
  ip_group
  srcg_lifestage_group
  check_judge_group
]

feature_group = {
  algorithm_list: [
    ${?HourModel}{ isJudgeModel = false, isFeatureModel = true,outputCols:[hour]}
    ${?IPsegModel}{ isJudgeModel = false, isFeatureModel = true,outputCols:[IPSeg]}
    ${?AgeModel}{ isJudgeModel = false, isFeatureModel = true}
    ${SearchEntranceTypeModel}{ isJudgeModel = false, isFeatureModel = true,outputCols:[srcType]}
    ${SrcExtractModel}{ isJudgeModel = false, isFeatureModel = true}
    ${BrowserExtractModel}{ isJudgeModel = false, isFeatureModel = true,outputCols:[browserName]}
    ${?AdClickHour}{isJudgeModel = false, isFeatureModel = true,inputCols: [ads_details.ad_clickdetails.click_time],outputCols: [adclick.hour]}
    ${DayOfWeekModel}{isJudgeModel = false, isFeatureModel = true,outputCols:[dayOfWeek]}
    ${AdClickPosMerge}{isJudgeModel = false, isFeatureModel = true,outputCols:[adpos.mixedPos],
      inputCols:[ads_details.location,ads_details.pos,ads_details.ad_clicknum]}
    ${AdClickViewGap}{isJudgeModel = false, isFeatureModel = true,outputCols:[adviewTime.logtime],
      inputCols:[ads_details.ad_clickdetails.click_view_gap]}
    ${AdClickPosXY}{isJudgeModel = false, isFeatureModel = true,outputCols:[adclickposX.adposX],
      inputCols:[ads_details.ad_clickdetails.position_x],
      binDesc:[50,100,150,200,250,300,350,400,450,500,550,600,650,651]
    }
    ${AdClickPosXY}{isJudgeModel = false, isFeatureModel = true,outputCols:[adclickposY.adposY],
      inputCols:[ads_details.ad_clickdetails.position_y],
      binDesc:[50,100,150,200,250,300,350,400,450,500,550,600,650,700,750,800,850,900,950,1000,1150,1200,1201]}
  ]
}

srcg_guid_group = {  #以guid为统计信息的算法集合
  groupkey:{statDimension:[site,srcg,guid]}
  major_feature_outputcols:[
    actionsCountScore,
    ActionEntropyScore,
    ipBinScore,
    qBinScore,
    adindustryScore,
    actionsTimeGapsScore,
    actionSpeedOn4
    adClickHourScore,
    posClickScore,
    ADClickViewGapScore,
    adClickPosXScore,
    adClickPosYScore,
    isBar
  ]
  algorithm_list:[
    ${FeaDistributeFeatureADD}{name: AdShowIndustryInfoDistribute,isFeatureModel=true,isJudgeModel=false,inputCols: [ads_details.industry],
      outputCols: [adShowIndustryStat], isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"],isBernoulli=true,
      validKeys=[
        游戏,
        IT产品,
        图书音像,
        教育培训,
        生活用品,
        商务服务,
        资讯,
        社交,
        电子商务,
        其他,
        机械设备,
        医疗健康,
        金融服务,
        装修装饰,
        交通类,
        食品餐饮,
        休闲娱乐,
        成人用品,
        招聘,
        电子电工,
        生活服务,
        家用电器,
        旅游
      ]
    }
    ${AdIndustryDistributeFeature}{name: adindustryDistribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [adShowIndustryStat,isBar], statLowerLimits: 3000
      , remitKey :{游戏:[0.37,0.02]}
      , outputCols: [adindustryScore, isBar, adindustryRelativeAntropy, adindustryCountStat, adindustryGapsBinScore,adindustryRatioStat]
      , standardDistribute: {
        教育培训:[0.1107085,0.010312],   //原始sigma=0.007312
        资讯:[0.0952084,0.0089091],    //原始sigma=0.0059091
        商务服务:[0.0942534,0.0089077],   //原始sigma=0.0059077
        IT产品:[0.0919479,0.010376],   //原始sigma=0.0060376
        图书音像:[0.0887698,0.0105291],   //原始sigma=0.0055291
        游戏:[0.0584008,0.0158274],    //原始sigma=0.0048274
        社交:[0.0571761,0.0074566],    //原始sigma=0.0044566
        other:[0.0504546,0.0072395],   //0.0042395
        电子商务:[0.0431243,0.0040209],
        其他:[0.0420877,0.0038205],
        金融服务:[0.0415101,0.0038613],
        交通类:[0.0323242,0.0034121],
        医疗健康:[0.0290045,0.0032273],
        生活服务:[0.0232606,0.0029323],
        旅游:[0.019961,0.0026139],
        生活用品:[0.0199229,0.0028191],
        招聘:[0.0179436,0.002592],
        食品餐饮:[0.0160515,0.0023743],
        机械设备:[0.0148506,0.0022604],
        成人用品:[0.0136483,0.0021803],
        装修装饰:[0.0128926,0.0021483],
        休闲娱乐:[0.0128253,0.0021211],
        电子电工:[0.0088628,0.0017884],
        家用电器:[0.0048104,0.0013064]
      },
      standardDistributeSecond: {
        IT产品:[0.1220339,0.0269904],    //原始sigma=0.0169904
        图书音像:[0.105553,0.0212812],    //原始sigma=0.0162812
        资讯:[0.1003701,0.0134414],     //原始sigma=0.0084414
        教育培训:[0.0979142,0.0205739],    //原始sigma=0.0155739
        游戏:[0.0791682,0.0282457],     //原始sigma=0.0182457
        商务服务:[0.0706472,0.0182136],    //原始sigma=0.0132136
        社交:[0.0546548,0.0102177],    //原始sigma=0.0072177
        other:[0.0473317,0.0105501],   //0.005508
        其他:[0.0402863,0.0038946],
        电子商务:[0.0394019,0.0046548],
        交通类:[0.0300295,0.0037989],
        生活用品:[0.0263206,0.0063761],
        医疗健康:[0.026102,0.0034956],
        金融服务:[0.0251801,0.0047608],
        生活服务:[0.0204154,0.0044328],
        成人用品:[0.0170698,0.0038488],
        食品餐饮:[0.0165111,0.002782],
        休闲娱乐:[0.0148286,0.0027084],
        旅游:[0.0143543,0.0031838],
        机械设备:[0.0134471,0.0024658],
        招聘:[0.0128221,0.0034987],
        装修装饰:[0.0126993,0.0023617],
        电子电工:[0.0077778,0.0019485],
        家用电器:[0.0050809,0.0014754]
      }
    }
    ${UserActionChainModel}{outputCols: [action_list,time_list],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${UserActionIndexModel}{inputCols: [action_list,time_list],outputCols: [action_time_list,action_time_id_list],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${GuidActionCount}{isFeatureModel=true,isJudgeModel=false,trainSource="local",transformTarget=["local"]
      ,inputCols:[action_list],outputCols:[actionCountStat],maxAction:20}
    ${DistributeFeature}{name: actionCount_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [actionCountStat,isBar], statLowerLimits: 1000
      ,remitKey :{2:[0.4046,0.0103]} //原始数据 2:[0.4546,0.0206],4:[0.105632069,0.008289399]
      , outputCols: [actionsCountScore, actionCountRelativeAntropy, totalActionCountStat, actionCountBinScore,totalActionRatioStat]
      , standardDistribute: {
        1:[0.140394773,0.010290321],
        2:[0.275204571,0.0222376],  //nature 原始数据为 [0.248313578,0.009105785]
        3:[0.0988229,0.0070582], // nature 原始数据为 [0.096557379,0.005424912]
        4:[0.0987206,0.005289399],  // nature 原始数据为[0.092632069,0.005289399]
        5:[0.0589853,0.004496839], // nature 原始数据为[0.054529877,0.004496839]
        6:[0.05411167,0.004312548],  // 原始数据为 [0.051769598,0.004312548]
        7:[0.036357574,0.003734276],
        8:[0.032512638,0.003357447],
        9:[0.025460465,0.002956127],
        10:[0.022623368,0.002709835],
        11:[0.018721942,0.002469693],
        12:[0.017030889,0.002325477],
        13:[0.014168215,0.002146527],
        14:[0.01257352,0.002006588],
        15:[0.010964388,0.001864307],
        16:[0.009857426,0.001782054],
        17:[0.008669987,0.001666957],
        18:[0.00788506,0.001597691],
        19:[0.006995384,0.001484168],
        20:[0.091981868,0.008766312]
      }}
    ${ActionEntropy}{ anomalyScoreThreshold = 0.6, inputCols: [action_time_list],isFeatureModel=true,isJudgeModel=false
      ,trainSource="local",transformTarget=["local","srcg_group"],
      outputCols:["ActionEntropyScore","ActionEntropy","totalActionList","ActionListPatternNumber","anomalyActionList","anomalyActionListScores"]}
    ${CTR}{outputCols: [SUV, SPV, CUV, CPV, ADCUV, ADCPV,ADSUV,ADSPV],hiddenDims: [site,srcg],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=[local,srcg_group]}
    ${FeaDistributeFeatureADD}{name:ipstat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
      inputCols: [ip],outputCols:[ipStat],isBernoulli=true}
    ${RedistributeByFrequency}{name:ipbin,isFeatureModel = true, isJudgeModel = false, trainSource = "local",transformTarget = ["local"]
      , inputCols: [ipStat,SPV],outputCols:[ipBinStat],unitSize=5000}
    ${DistributeFeature}{name: ipbin_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [ipBinStat], statLowerLimits: 1000
      , outputCols: [ipBinScore, ipBinRelativeAntropy, ipBinCountStat, ipBinScore,ipBinRatioStat]
      , standardDistribute: {
        1:[0.995183695,0.004494854],
        2:[0.003502957,0.003657877],
        3:[0.0007960,0.0016434 ],
        4:[0.0003250,0.0010251],
        5:[0.0001240,0.0006650],
        6:[0.0000569,0.0004740 ],
        7:[0.0000284,0.0003630],
        8:[0.0000165,0.0003000 ],
        9:[0.0000188,0.0003420],
        10:[0.0000155,0.0003270],
        15:[0.0000064,0.0002350],
        30:[0.0000064,0.0002350],
        100:[0.0000064,0.0002350],
        1000:[0.0000064,0.0002350]
      }
    }
    ${FeaDistributeFeatureADD}{name:qstat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
      inputCols: [q],outputCols:[qStat],isBernoulli=true}
    ${RedistributeByFrequency}{name:qbin,isFeatureModel = true, isJudgeModel = false, trainSource = "local",transformTarget = ["local"]
      , inputCols: [qStat,SPV],outputCols:[qBinStat],unitSize=5000}
    ${DistributeFeature}{name: qbin_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [qBinStat], statLowerLimits: 1000
      , outputCols: [qBinScore, qBinRelativeAntropy, qBinCountStat, qBinScore,qBinRatioStat]
      , standardDistribute: {
        1:[0.87693,0.02218],
        2:[0.03568,0.01145],
        3:[0.01547,0.00526],
        4:[0.00915,0.00368],
        5:[0.00683,0.00314],
        6:[0.00593,0.00292],
        7:[0.00504,0.00289],
        8:[0.00428,0.00284],
        9:[0.00371,0.0028],
        10:[0.00345,0.00291],
        15:[0.01575,0.00715],
        30:[0.0139,0.00724],
        100:[0.00389,0.00658],
        1000:[0.00389,0.00658],
        1001:[0.00389,0.00658]
      }
    }
    ${GuidTimeGap}  {isFeatureModel = true, isJudgeModel = false,transformTarget = ["local"]
      inputCols:[time_list],outputCols:[actionTimeGapsStat]}
    ${DistributeFeature}{name: TimeGapsDistribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , remitKey :{0:[0.3333,0.0064666],1:[0.1333,0.0128233]}  //原始数据 {0:[0.3533,0.0124666],1:[0.1333,0.0128233]}
      , transformTarget = ["local", "srcg_group"], inputCols: [actionTimeGapsStat,isBar], statLowerLimits: 7000
      , outputCols: [actionsTimeGapsScore, actionTimeGapsRelativeAntropy, actionTimeGapsCountStat, actionTimeGapsBinScore,actionTimeGapsRatioStat]
      , standardDistribute: {
        0:[0.199696978,0.0199696978], //原始值sigma 0.011218512
        1:[0.10978022,0.010978022],   //原始值sigma 0.005647234
        2:[0.076809308,0.0096011635],  //原始值sigma 0.003609714
        3:[0.061370073,0.007671259125],  //原始值sigma 0.002570068
        4:[0.048106538,0.00601331725],  //原始值sigma 0.001993678
        5:[0.040214452,0.0050268065],  //原始值sigma 0.002044997
        6:[0.034036596,0.0042545745],  //原始值sigma 0.002094258
        7:[0.028717716,0.0057435432],  //原始值sigma 0.002141718
        8:[0.024950191,0.0049900382],  //原始值sigma 0.002119799
        9:[0.022385036,0.0044770072],    //原始值sigma 0.0024387
        10:[0.020355168,0.0040710336], //原始值sigma 0.002711044
        11:[0.017852122,0.0035704244], //原始值sigma 0.002480682
        12:[0.014087521,0.0028175042], //原始值sigma 0.001318551
        13:[0.012462667,0.0024925334],  //原始值sigma 0.001137586
        14:[0.011538658,0.0023077316], //原始值sigma 0.001331663
        15:[0.010817793,0.0021635586], //原始值sigma 0.001529212
        16:[0.009905575,0.0033018583],  //原始值sigma 0.00149323
        17:[0.00868946,0.003475784],  //原始值sigma 0.001147407
        18:[0.007360262,0.003680131],  //原始值sigma 0.0007377353
        19:[0.006190174,0.003095087],  //原始值sigma 0.0006110421
        20:[0.005598265,0.0027991325],  //原始值sigma 0.00061103
        21:[0.005214781,0.0026073905],  //原始值sigma 0.0006040589
        22:[0.004842806,0.004842806],  //原始值sigma 0.0005914654
        23:[0.004540848,0.004540848],  //原始值sigma 0.0005669078
        24:[0.004271646,0.004271646],  //原始值sigma 0.0005464016
        25:[0.004023373,0.004023373],  //原始值sigma 0.0005215135
        26:[0.003815648,0.003815648],  //原始值sigma 0.0005008158
        27:[0.003608491,0.003608491],  //原始值sigma 0.0004771071
        28:[0.003417227,0.003417227],  //原始值sigma 0.0004638865
        29:[0.003236913,0.003236913], //原始值sigma 0.0004482552
        30:[0.003066494,0.003066494], //原始值sigma 0.0004439845
        31:[0.002899311,0.002899311], //原始值sigma 0.000433573
        32:[0.002755068,0.002755068], //原始值sigma 0.0004283732
        33:[0.002623265,0.002623265], //原始值sigma 0.0004185197
        34:[0.002508511,0.002508511],  //原始值sigma 0.0004103572
        35:[0.002403841,0.002403841],  //原始值sigma 0.0003993530
        36:[0.002299522,0.002299522],  //原始值sigma 0.0003889054
        37:[0.002214746,0.002214746],  //原始值sigma 0.0003835008
        38:[0.002128319,0.002128319],  //原始值sigma 0.0003715109
        39:[0.002047812,0.002047812], //原始值sigma 0.0003637623
        40:[0.165991702,0.0165991702], //原始值sigma 0.0060273762
      }
    }
    ${ActionSpeedModel}{inputCols:[time_list],sequenceCount:4,outputCols:[actionSpeedOn4],isFeatureModel=true,isJudgeModel=false,trainSource="local",transformTarget=["local"]}
    ${FeaDistributeFeatureADD}{name:AdClickHourStat, inputCols: [adclick.hour],isFeatureModel=true,isJudgeModel=false
      ,outputCols: [adClickHourStat],trainSource="global",transformTarget=["local"]}
    ${DistributeFeature}{name: AdClickHourDistribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [adClickHourStat,isBar], statLowerLimits: 3000
      , remitKey :{0:[0.05,0.008],1:[0.036,0.007],2:[0.025,0.005],3:[0.025,0.005],4:[0.025,0.005],5:[0.025,0.005],6:[0.025,0.005],}
      , outputCols: [adClickHourScore, adClickHourRelativeAntropy, adClickHourCountStat, adClickHourBinScore, adClickHourRatioStat]
      , standardDistribute: {
        0:[0.008339282,0.006138283],
        1:[0.004454596,0.004616034],
        2:[0.002994961,0.003648757],
        3:[0.002060422,0.003229868],
        4:[0.001682584,0.002755108],
        5:[0.002062956,0.003054893],
        6:[0.003895807,0.004230148],
        7:[0.010146349,0.006605784],
        8:[0.047604853,0.013566905],
        9:[0.092585945,0.018913962],
        10:[0.103559941,0.020017409],
        11:[0.087327349,0.018354353],
        12:[0.045215518,0.013830295],
        13:[0.057856994,0.015335958],
        14:[0.088935208,0.018949809],
        15:[0.097804822,0.019732235],
        16:[0.089700857,0.01876666],
        17:[0.065458022,0.016175933],
        18:[0.039362469,0.013399667],
        19:[0.036990863,0.012801754],
        20:[0.037624714,0.013078456],
        21:[0.033955649,0.012541603],
        22:[0.025468552,0.010755523],
        23:[0.014911286,0.008341183]
      },
      standardDistributeSecond: {
        0:[0.013737188,0.009115194],
        1:[0.007384007,0.006878422],
        2:[0.004772677,0.005522318],
        3:[0.003285846,0.004631179],
        4:[0.002579215,0.0039640251],
        5:[0.00301664,0.004247294],
        6:[0.005726146,0.006019894],
        7:[0.013477281,0.00865076],
        8:[0.038520192,0.014457956],
        9:[0.069541241,0.01932012],
        10:[0.082918537,0.021399202],
        11:[0.074143834,0.02019982],
        12:[0.052745352,0.01709423],
        13:[0.060351442,0.018061171],
        14:[0.076398456,0.020710944],
        15:[0.083096983,0.021365289],
        16:[0.079977359,0.020719975],
        17:[0.066386341,0.018655389],
        18:[0.050636693,0.016610267],
        19:[0.050418323,0.01693524],
        20:[0.052849111,0.017679255],
        21:[0.047991162,0.016811307],
        22:[0.037156975,0.014944028],
        23:[0.022888999,0.011895821]
      }
    }
    ${FeaDistributeFeatureADD}{name: posClickStat,inputCols:[click_details.pos],outputCols:[posClickStat]
      ,isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"],
      validKeys=[1,2,3,4,5,6,7,8,9,10,banner,side,unk]}
    ${DistributeFeature}{name:posClickDistribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [posClickStat,isBar], statLowerLimits: 2000
      , remitKey :{1:[0.58,0.02]} //原始 {1:[0.64,0.02],2:[0.125264096,0.010126]}
      , outputCols: [posClickScore, posClickRelativeAntropy, posClickCountStat, posClickBinScore, posClickRatioStat]
      , standardDistribute:{
        1:[0.53710778,0.018514798],   # 实际自然流量已经到0.52， 我们这次改成0.54，原来是0.495
        2:[0.141264096,0.005513421],
        3:[0.085455592,0.004845625],
        4:[0.055542668,0.003460121],
        5:[0.042648836,0.003010307],
        6:[0.033349732,0.002453588],
        7:[0.026807054,0.002394105],
        8:[0.023445959,0.002393138],
        9:[0.020974414,0.002097075],
        10:[0.019828526,0.001972948],
        side:[0.044867672,0.008851217],
        banner:[0.00028072,0.00032650],
        unk:[0.008418297,0.002333661],
        other:[0.00000817940,0.00003516335]
      }
    }
    ${FeaDistributeFeatureADD}{name:HourStat, inputCols: [hour],isFeatureModel=true,isJudgeModel=false
      ,outputCols: [HourStat],trainSource="global",transformTarget=["local"]}
    ${DistributeFeature}{
      name: HourDistribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [HourStat], statLowerLimits: 5000
      , outputCols: [HourScore, HourRelativeAntropy, HourCountStat, HourBinScore, HourRatioStat]
      , standardDistribute: {
        0: [0.01, 0.01],
        1: [0.01, 0.01],
        2: [0.01, 0.01],
        3: [0.01, 0.01],
        4: [0.01, 0.01],
        5: [0.01, 0.01],
        6: [0.01, 0.01],
        7: [0.01, 0.01],
        8: [0.01, 0.01],
        9: [0.2, 0.01],
        10: [0.2, 0.01],
        11: [0.2, 0.01],
        12: [0.01,0.01],
        13: [0.01,0.01],
        14: [0.01,0.01],
        15: [0.2, 0.01],
        16: [0.01,0.01],
        17: [0.01,0.01],
        18: [0.01,0.01],
        19: [0.01,0.01],
        20: [0.01,0.01],
        21: [0.01,0.01],
        22: [0.01,0.01],
        23: [0.01,0.01]
      }
    }
//    ${FeaDistributeFeatureADD}{name:adposStat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
//      inputCols: [adpos.mixedPos],outputCols:[adposStat],
//      validKeys=[
//        "left(1)",
//        "left(2)",
//        "left(3)",
//        "left(4)",
//        "left(5)",
//        "bottom(1)",
//        "goods_box(5)",
//        "bottom(2)",
//        "box(1)",
//        "goods_box(4)",
//        "goods_box(3)",
//        "bottom(3)",
//        "right(1)",
//        "goods_box(2)",
//        "right(2)",
//        "dygoods(1)",
//        "bottom(4)",
//        "right(3)",
//        "box(2)",
//        "right(4)",
//        "dygoods(2)",
//        "right(5)",
//        "box(3)",
//        "right(6)",
//        "dygoods(3)",
//        "dygoods(4)",
//        "right(7)",
//        "right(8)",
//        "box(4)"
//      ]
//    }
//    ${DistributeFeature}{name: ADClickPos_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
//      , transformTarget = ["local", "srcg_group"], inputCols: [adposStat,isBar], statLowerLimits: 3000
//      , remitKey :{"left(1)":[0.62,0.02],"left(2)":[0.185,0.005]}
//      , outputCols: [ADClickPosScore, ADClickPosRelativeAntropy, ADClickPosStat, ADClickPosBinScore, ADClickPosRatioStat]
//      , standardDistribute: {
//        "left(1)":[0.5838443,0.0275779],
//        "left(2)":[0.1877436,0.0170683],
//        "left(3)":[0.0933434,0.0127861],
//        "left(4)":[0.0497298,0.0099714],
//        "left(5)":[0.0266421,0.0079334],
//        "bottom(1)":[0.0186676,0.0067419],
//        "goods_box(5)":[0.0076666,0.0044287],
//        "bottom(2)":[0.007173,0.0039709],
//        "box(1)":[0.0066968,0.0038152],
//        "goods_box(4)":[0.0037694,0.0031046],
//        "goods_box(3)":[0.0026596,0.0024782],
//        "bottom(3)":[0.0019155,0.0019815],
//        "right(1)":[0.0016393,0.0018825],
//        "goods_box(2)":[0.0015166,0.0018408],
//        "right(2)":[0.0009987,0.001552],
//        "dygoods(1)":[0.000831,0.0013879],
//        "bottom(4)":[0.0008087,0.0012488],
//        "right(3)":[0.0006737,0.0013088],
//        "box(2)":[0.0005145,0.0008834],
//        "right(4)":[0.0004922,0.0011773],
//        "dygoods(2)":[0.0003804,0.0008814],
//        "right(5)":[0.0003628,0.0009734],
//        "box(3)":[0.0002934,0.000652],
//        "right(6)":[0.0002917,0.0008395],
//        "dygoods(3)":[0.0002899,0.0007392],
//        "dygoods(4)":[0.0002477,0.0007116],
//        "right(7)":[0.000232,0.0007548],
//        "right(8)":[0.0001912,0.0006599],
//        "box(4)":[0.0001861,0.0005345],
//        "other":[0.0001985,0.001]  // 原始sigma0.0006621233
//      }
//    }
    ${FeaDistributeFeatureADD}{name:adviewTimeStat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
      inputCols: [adviewTime.logtime],outputCols:[adviewTimeStat]}
    ${DistributeFeature}{name: ADClickViewGap_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [adviewTimeStat,isBar], statLowerLimits: 3000
      , remitKey :{1:[0.450,0.01]} //原始 {1:[0.450,0.02]}
      , outputCols: [ADClickViewGapScore, ADClickViewGapRelativeAntropy, ADClickViewGapStat, ADClickViewGapBinScore, ADClickViewGapRatioStat]
      , standardDistribute: {
        1:[0.3121284,0.0221547],
        2:[0.2972572,0.020004],
        3:[0.1556931,0.0158017],
        4:[0.0909305,0.0133301],
        5:[0.0544961,0.0115474],
        6:[0.0309727,0.0093256],
        0:[0.0286824,0.0080341],
        7:[0.0158072,0.0076323],
        8:[0.0077392,0.0075372],
        9:[0.004169,0.0072893],
        10:[0.0020228,0.005821],
        11:[0.0001014,0.0004685]
      }
    }
    ${FeaDistributeFeatureADD}{name:adClickPosXStat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
      inputCols: [adclickposX.adposX],outputCols:[adClickPosXStat]}
    ${DistributeFeature}{name: adClickPosX_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [adClickPosXStat], statLowerLimits: 3000
      , outputCols: [adClickPosXScore, adClickPosXRelativeAntropy, adClickPosXStat, adClickPosXBinScore, adClickPosXRatioStat]
      , standardDistribute: {
        200:[0.2200075,0.020648022],  // 原始 sigma = 0.0194142
        150:[0.1938122,0.0227309],  //原始 sigma = 0.0192894
        250:[0.1809016,0.02012945],  // 原始 sigma = 0.0199493
        100:[0.1519731,0.022044627], //原始sigma = 0.0198954
        300:[0.113559,0.01706341],   // 原始sigma = 0.0153685
        350:[0.0661856,0.0135322],   // 原始 simga = 0.0118371
        400:[0.0281253,0.01026161],  // 原始 sigma = 0.0077148 当前 0.00826161572
        50:[0.0237619,0.0102469456],  //原始sigma = 0.0079269  当前0.00824694568003458
        450:[0.0094053,0.0045497],
        500:[0.0088665,0.0045533],
        550:[0.0025529,0.0023542],
        650:[0.0004155,0.0009799],
        600:[0.0002602,0.0007137],
        651:[0.0001734,0.005]  //原始sigma 0.00141631
      }
    }
    ${FeaDistributeFeatureADD}{name:adClickPosYStat,isFeatureModel = true, isJudgeModel = false, trainSource = "global",transformTarget = ["local"]
      inputCols: [adclickposY.adposY],outputCols:[adClickPosYStat]}
    ${DistributeFeature}{name: adClickPosY_distribute, isFeatureModel = true, isJudgeModel = false, trainSource = "local"
      , transformTarget = ["local", "srcg_group"], inputCols: [adClickPosYStat], statLowerLimits: 3000
      , outputCols: [adClickPosYScore, adClickPosYRelativeAntropy, adClickPosYStat, adClickPosYBinScore, adClickPosYRatioStat]
      , standardDistribute: {
        50:[0.5116593,0.03858212], //原始 sigma = 0.0281369
        150:[0.0883372,0.0147029],  // 原始 simga = 0.0132735
        200:[0.0665592,0.017611],  // 原始 simga = 0.0124596
        300:[0.0488644,0.0111628],
        250:[0.0465187,0.010669],
        400:[0.0315584,0.0083254],
        100:[0.0303978,0.01008871], // 原始 simga = 0.0093453
        350:[0.0284309,0.0094968],  // 原始 simga = 0.0075911
        450:[0.0255202,0.0072185],
        500:[0.0226948,0.006508],
        550:[0.0173592,0.0068752],
        600:[0.0155237,0.0053748],
        650:[0.0132859,0.0049844],
        700:[0.0105625,0.004445],
        750:[0.0080523,0.004301],
        800:[0.0069523,0.0044005],
        850:[0.0059556,0.0033875],
        1150:[0.0055106,0.0034094],
        900:[0.0044726,0.0029173],
        950:[0.0037388,0.0029637],
        1000:[0.0030642,0.0024814],
        1201:[0.0039253,0.005],  // 原始sigma 0.0033265
        1200:[0.001056,0.0014071]
      }
    }

    ${?QueryChangeTooQuick4pc}{name="QueryChangeTooQuick4pcCheck",inputCols:[tp,q,ts],
      outputCols:[QueryChangeTooQuick4pcCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}

  ]
}
srcg_group = {
  groupkey:{statDimension:[site,srcg]}
  major_feature_outputcols:[
    secondSearchRate
    age0Rate,
    SPV,
    SUV,
    ADSUV,
    ADCUV,
    ADCPV2ADSPV,
    CPV2SPV,
    SPV2SUV,
    CPV2CUV,
    CUV2SUV,
    ADSPV2ADSUV,
    ADCPV2ADCUV,
    ADCUV2ADSUV,
    ADCUV2CUV,
    ADCUV2SUV,
    posClickInfoCount,
    hourInfoCount,
    adClickHourInfoCount,
    adClickPosInfoCount,
    adShowIndustryInfoCount,
    adClickIndustryInfoCount,
    ipInfoCount,
    adClickIpInfoCount,
    SugSearchInfoRate,
    SUV2IpInfoCount,
    ADCUV2adClickIpInfoCount,
    isInternetBar
  ]
  algorithm_list:[
    ${NumericFeatureAdd}{name:SecondSearchCount,inputCols:["srcType|srcType==search2"],outputCols:[secondSearchCount], isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name: SugFinalCount,expression: "secondSearchCount/SPV",outputCols:[secondSearchRate],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${NumericFeatureAdd}{name:Age0Count,inputCols:["age|age==0"],outputCols:[age0Count], isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:Age0Rate,expression:"age0Count/SPV",outputCols:[age0Rate], isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCPV2ADSPV,expression:"ADCPV/ADSPV",outputCols:[ADCPV2ADSPV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:CPV2SPV,expression:"CPV/SPV",outputCols:[CPV2SPV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:SPV2SUV,expression:"SPV/SUV",outputCols:[SPV2SUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:CPV2CUV,expression:"CPV/CUV",outputCols:[CPV2CUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:CUV2SUV,expression:"CUV/SUV",outputCols:[CUV2SUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADSPV2ADSUV,expression:"ADSPV/ADSUV",outputCols:[ADSPV2ADSUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCPV2ADCUV,expression:"ADCPV/ADCUV",outputCols:[ADCPV2ADCUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCUV2ADSUV,expression:"ADCUV/ADSUV",outputCols:[ADCUV2ADSUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCUV2CUV,expression:"ADCUV/CUV",outputCols:[ADCUV2CUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCUV2SUV,expression:"ADCUV/SUV",outputCols:[ADCUV2SUV],isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${DiscreteFeatureAdd}{name: PosClickInfoCount,
      inputCols:[click_details.pos,hour,adclick.hour,"ads_details.pos|ads_details.ad_clicknum>0",ads_details.industry,"ads_details.industry|ads_details.ad_clicknum>0",ip,"ip|ads_clicknum>0"],
      outputCols:[posClickInfoCount,hourInfoCount,adClickHourInfoCount,adClickPosInfoCount,adShowIndustryInfoCount,adClickIndustryInfoCount,ipInfoCount,adClickIpInfoCount],
      MaxValue:true,isFeatureModel=true,isJudgeModel=false,trainSource="global",transformTarget=["local"]}
    ${NumericFeatureAdd}{name:SugSearchInfoCount,inputCols:[sug_q|sug_pos>0,"sug_disp|sug_disp==1"],
      outputCols:[sugInCount,sugShowCountmiddle],
      isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:SugSearchInfoRate,expression:"(sugInCount+sugShowCountmiddle)/SPV",outputCols:[sugSearchInfoRate],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:SUV2IpInfoCount,expression:"SUV/ipInfoCount",outputCols:[SUV2IpInfoCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:ADCUV2adClickIpInfoCount,expression:"ADCUV/adClickIpInfoCount",outputCols:[ADCUV2adClickIpInfoCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${ConditionalFeature}{name:internetBar,outputCols:[isInternetBar]
      ,ifExpr:"site in ('http://www.wb123.com','http://nav.bohaiqilin.com','https://www.52daohang.com','http://www.feihuo.com') and adindustryCountStat like '游戏%'"
      ,ifValueExpr:1 ,defaultValue:0
      ,isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]
    }
    ${?IdlePeriod}{name="IdlePeriodCheck",inputCols:[hour,srcg,site,t],
      outputCols:[IdlePeriodCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
    ${?SearchtimeEntropy}{name="SearchtimeEntropyCheck",inputCols:[hour,srcg,site,isBar],
      outputCols:[SearchtimeEntropyCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
    ${?QueryIsDigital}{QueryIsDigitalRatio=0.05, statLowerLimits=200.0,inputCols:[q],name="QueryIsDigitalCheck"
      outputCols:[QueryIsDigitalCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
    ${?ClickSite}{name="ClickSiteCheck",inputCols:[click_details],
      outputCols:[ClickSiteCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
  ]
}

guid_group = {  #以guid为统计信息的算法集合
  groupkey:{statDimension:[guid]}
  major_feature_outputcols:[
    scrgCount,
    adshowIndustryCount,
    adshowSubIndustryCount,
    adclickSubIndustryCount,
    adclickIndustryCount,
    minispv,
    cpv,
    adshow,
    AdclickNum,
    ipCount,
    cityCount,
    hourCount,
    queryCount,
    pageCount,
    browserCount,
    adclickHourCount,
    firstSearchCount,
    secondSearchCount,
    sugInCount,
    sugShowCountmiddle,
    sugShowCount,
    adUserIdCount,
    adAdvertIdCount,
    adUserIdmaxcount,
    adAdvertIdmaxcount,
  ]
  algorithm_list:[
    ${DiscreteFeatureAdd}{name="SrcgIndustryCountFeatureAddTF",MaxValue:true,inputCols:[srcg,ads_details.industry,ads_details.sub_industry,"ads_details.sub_industry|ads_details.ad_clicknum>0","ads_details.industry|ads_details.ad_clicknum>0"],
      outputCols:[scrgCount,adshowIndustryCount,adshowSubIndustryCount,adclickSubIndustryCount,adclickIndustryCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${NumericFeatureAdd}{name="SPV_CPV_ETC",inputCols:[sid,click_num,ads_num,ads_clicknum],
      outputCols:[minispv,cpv,adshow,AdclickNum],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${DiscreteFeatureAdd}{name="Ip_City_Query_Page_browser_Feature",MaxValue:true,inputCols:[ip,ict,hour,q,pn,browserName,adclick.hour]
      ,outputCols:[ipCount,cityCount,hourCount,queryCount,pageCount,browserCount,adclickHourCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${NumericFeatureAdd}{name:"Src_Sug_Info",inputCols:["srcType|srcType==search1","srcType|srcType==search2",sug_q|sug_pos>0,"sug_disp|sug_disp==1"]
      ,outputCols:[firstSearchCount,secondSearchCount,sugInCount,sugShowCountmiddle],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${FeaBasicOperationFeatureADD}{name:"SugFinalCountFeature",expression: "sugInCount+sugShowCountmiddle",outputCols: [sugShowCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${AdAdvertIdDiscreteFeatureAddTF}{name="adUserStat",inputCols:[ads_details.ad_user_id|ads_details.ad_clicknum>0,ads_details.ad_clicknum],
      outputCols:[adUserIdCount,adUserIdmaxcount,adUserIdmaxrate],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${AdAdvertIdDiscreteFeatureAddTF}{name="advertIDStat",inputCols:[ads_details.ad_advert_id|ads_details.ad_clicknum>0,ads_details.ad_clicknum],
      outputCols:[adAdvertIdCount,adAdvertIdmaxcount,adAdvertIdmaxrate],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${?SearchCrawler}{name="SearchCrawlerCheck",inputCols:[q],
      outputCols:[SearchCrawlerCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
    ${?CityChangeTooQuick}{SpamThreshold:2.0,name="CityChangeTooQuickCheck",inputCols:[ict,hour],
      outputCols:[CityChangeTooQuickCheck],isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]
    }
  ]
}

srcg_lifestage_group = {  #以guid为统计信息的算法集合
  groupkey:{statDimension:[site,srcg,lifestage]}
  algorithm_list:[
    ${?ClickPos4pc}{name="ClickPos4pcCheck", isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}
  ]
}

ip_group = {  #以guid为统计信息的算法集合
  groupkey:{statDimension:[ip]}
  major_feature_outputcols:[
//    ipSrcgCount,
//    ipSiteCount
  ]
  algorithm_list:[
//    ${DiscreteFeatureAdd}{name="ipSrcgSiteCount",MaxValue:true,inputCols:[srcg,site],
//      outputCols:[ipSrcgCount,ipSiteCount],isFeatureModel=true,isJudgeModel=false,transformTarget=["local"]}
    ${?SrcgSearchSameTimes}{name="SrcgSearchSameTimesCheck",outputCols:[SrcgSearchSameTimesCheck], isFeatureModel=false,isJudgeModel=true,transformTarget=["global"]}

  ]
}

//val commercial = Value(0,"CommercialAntiSpam")
//val guid = Value(1,"BusyUser")
//val distribute = Value(2,"DistributeDisorder")
//val invalid = Value(3,"InvalidBehavior")

check_judge_group = {
  algorithm_list:[
    // guid_group
    // orignal mean = 1.31，sigma =0.7 ，加大一倍，判黑阈值10，判灰阈值7
    //all_nature:  mean:1.88225 simga:1.308952，判黑阈值18，判灰阈值13
    // linsu： 2020/08/07 重新修改， 大约5倍的sig判黑， 3倍sigma判灰
    //0810, 只判灰
    ${Check}{name:AdShowIndustryCheck,anomalyExpr:"adshowIndustryCount>=6",antiSpamType="BusyUser"
      , outputCols:[AdShowIndustryCheck],isFeatureModel=false,isJudgeModel=true,}
    // AdShowSubIndustryCheck ori mean = 1.394，sigma = 0.895， 但是由于和AdShowIndustry 共现性非常高， 所以只判一些极值，判黑阈值20，判灰阈值10
    //all_nature: mean: 2.1486585 sigma:1.6616096
    // linsu： 2020/08/07 2 但是由于和AdShowIndustry 共现性非常高， 所以只判一些极值，判黑阈值20，判灰阈值10
    ${Check}{name:AdShowSubIndustryCheck,spamExpr:"adshowSubIndustryCount>20",anomalyExpr:"adshowSubIndustryCount>10",antiSpamType="BusyUser"
      ,outputCols:[AdShowSubIndustryCheck],isFeatureModel=false,isJudgeModel=true,}
    //mean = 1.046，sigma = 0.242,判黑：4，判灰：3
    //all_nature: mean:1.148196516 sigma:0.457448811
    // linsu： 2020/08/07  5倍sigma黑，3倍 sigma 灰
    // 0810 只判灰
    ${Check}{name:AdClickIndustryCheck,anomalyExpr:"adclickIndustryCount>=3",antiSpamType="BusyUser"
      ,outputCols:[AdClickIndustryCheck],isFeatureModel=false,isJudgeModel=true,}
    //mean = 1.061 sigma= 0.301  //由于与AdClickIndustryCheck接近，所以 判黑是 5
    //all_nature:  mean:1.2016998 sigma:0.57557459
    // linsu： 2020/08/07  ，5倍sigma判黑， 0810 只判灰
    // linsu  0902 , 共现性比较好， 由 5改成4
    ${Check}{name:AdClickSubIndustryCheck,anomalyExpr:"adclickSubIndustryCount>=4",antiSpamType="BusyUser"
      ,outputCols:[AdClickSubIndustryCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留，比较合理
    //origin: mean:1.50,sigma:2.42,判黑：5.33，判灰：4.5
    //all_nature: mean:1.9975868 sigma:6.002187
    //linsu 0902 共现性比较好， 阈值降低，anomaly 由 4.5 改成3.5
    ${Check}{name:AdClickNumCheck,spamExpr:"abs(AdclickNum-1.9975868)/6.002187>5.33",anomalyExpr:"abs(AdclickNum-1.9975868)/6.002187>3.5",antiSpamType="BusyUser"
      ,outputCols:[AdClickNumCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留，比较合理 mean：9.51，sigma:28.24,判黑：5.33，判灰：4.5
    //all_nature: mean：19.70278 simga：66.6379056890717，
    // 林谡 0810 ，只判灰
    //linsu 0902 共现性比较好， 阈值降低，anomaly 由 4.5 改成3.5
    ${Check}{name:AdShowCheck,anomalyExpr:"abs(adshow-19.70278)/66.6379056890717>3.5",antiSpamType="BusyUser"
      ,outputCols:[AdShowCheck],isFeatureModel=false,isJudgeModel=true,}
    //自然流量给的太宽泛，直接取阈值，判黑：6，判灰：3
    //all_nature: mean:1.1849087 sigma:22.837140290912
    ${Check}{name:IpCheck,spamExpr:"ipCount>6",anomalyExpr:"ipCount>3",antiSpamType="BusyUser"
      ,outputCols:[IpCheck],isFeatureModel=false,isJudgeModel=true,}

    //  保留不动，足够宽泛，mean:1.014,sigma:0.6,判黑：5.33，判灰：4.5
    //all_nature mean:1.027990 simga:0.4433159
    //linsu 0902 共现性比较好， 阈值降低，spam 由 5.33 改成 4.5 ，anomaly 由 4.5 改成3.5
    ${Check}{name:CityCheck,spamExpr:"abs(cityCount-1.027990 )/0.4433159>4.5",anomalyExpr:"abs(cityCount-1.027990)/0.4433159>3.5",antiSpamType="BusyUser"
      ,outputCols:[CityCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛 mean:1.604,sigma:1.18,判黑：5.33，判灰：4.5
    //all_nature mean:2.35844 simga:1.915821
    //linsu 0810  只判灰
    ${Check}{name:HourCheck,anomalyExpr:"abs(hourCount-2.35844)/1.915821>4.5",antiSpamType="BusyUser"
      ,outputCols:[HourCheck],isFeatureModel=false,isJudgeModel=true,}
    //保留不动，足够宽泛 mean:2.42,sigma:20.96,判黑：5.33，判灰：4.5
    //all_nature mean:5.931709 simga:24.758155
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 4.5 改成3.5
    ${Check}{name:QueryCheck,spamExpr:"abs(queryCount-5.931709)/24.758155>5.3",anomalyExpr:"abs(queryCount-5.931709)/24.758155>3.5",antiSpamType="BusyUser"
      ,outputCols:[QueryCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛 mean:2.72 simga:49.90，判黑：5.33，判灰：4.5
    //all_nature: mean:7.9470791 simga:101.599826542552
    // linsu 2020/08/07 spv应该事2.7个，不会更多
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 3 改成2.5
    ${Check}{name:SPVCheck,spamExpr:"abs(minispv-2.72)/49.90>5.33",anomalyExpr:"abs(minispv-2.72)/49.90>2.5",antiSpamType="BusyUser"
      ,outputCols:[SPVCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛 mean:3.587 simga:36.78，判黑：5.33，判灰：4.5
    //all_nature:  mean 8.679041 sigma:69.1945678257497
    // linsu 2020/08/07 cpv应该事3.587个，不会更多
    ${Check}{name:CPVCheck,spamExpr:"abs(cpv-3.587)/36.78>5.33",anomalyExpr:"abs(cpv-3.587)/36.78>3",antiSpamType="BusyUser"
      ,outputCols:[CPVCheck],isFeatureModel=false,isJudgeModel=true,}
    // 足够合理
    ${Check}{name:BrowserCheck,spamExpr:"abs(browserCount)>1",antiSpamType="BusyUser"
      ,outputCols:[BrowserCheck],isFeatureModel=false,isJudgeModel=true,}
    // 足够合理
    ${Check}{name:SpiderCheck,spamExpr:"browserName='Robot/Spider'",antiSpamType="BusyUser"
      ,outputCols:[SpiderCheck],isFeatureModel=false,isJudgeModel=true,}

    // page 看来结果不好，不要这个策略了
    //    ${Check}{name:PageCheck,spamExpr:"abs(pageCount-1.08)/0.53>5.33",anomalyExpr:"abs(pageCount-1.08)/0.53>4.5"
    //      ,outputCols:[PageCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛 mean:1.604, sigma:1.18,判黑：5.33，判灰：4.5
    //all_nature: mean 1.177732 sigma 0.51475718
    // linsu 2020/08/07,  sigma 0.51475718， 0810： 全部只判灰， 不再判黑
    ${Check}{name:AdClickHourCheck,anomalyExpr:"abs(adclickHourCount-1.177732)/0.51475718>4.5",antiSpamType="BusyUser"
      ,outputCols:[AdClickHourCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛mean:1.71, sigma:5.86,判黑：5.33，判灰：4.5
    //all_nature   mean:3.829888190 simga:14.373533，全部只判灰， 不再判黑
    ${Check}{name:FirstSearchCheck,anomalyExpr:"abs(firstSearchCount-1.71)/5.86>4.5",antiSpamType="BusyUser"
      ,outputCols:[FirstSearchCheck],isFeatureModel=false,isJudgeModel=true,}
    // 保留不动，足够宽泛mean:2.57, sigma:65,判黑：5.33，判灰：4.5
    //all_nature:mean:6.443729683  simga:118.3525904，全部只判灰， 不再判黑
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 4.5 改成3.5
    ${Check}{name:SecondSearchCheck,anomalyExpr:"abs(secondSearchCount-2.57)/65>3.5",antiSpamType="BusyUser"
      ,outputCols:[SecondSearchCheck],isFeatureModel=false,isJudgeModel=true,}
    // linsu 0806 , 有20个spv就是可以判定了
    ${Check}{name:CTRLowCheck,spamExpr:"minispv>20 and cpv/minispv<0.2",anomalyExpr:"minispv>20 and cpv/minispv<0.3",outputCols:[CTRLowCheck],
      isFeatureModel=false,isJudgeModel=true,antiSpamType="BusyUser"}

    ${Check}{name:ADclickTooMuchCheck,anomalyExpr:"adclick>15 and cpv/adclick<0.1",outputCols:[ADclickTooMuchCheck],
      isFeatureModel=false,isJudgeModel=true,antiSpamType="BusyUser"}

    //srcg_guid
    // allnature mean:26.55816 stddev:32.26871786,
    // 0810， speed 100ms
    ${Check}{name:actionSpeedOn4Check,spamExpr:"actionSpeedOn4<0.1",anomalyExpr:"actionSpeedOn4<0.3",antiSpamType="BusyUser"
      ,outputCols:[actionSpeedOn4Check],isFeatureModel=false,isJudgeModel=true,}

    // sug 类别的不好定义作弊， 而且数量多的判断与spv，adclick等数量判断重复
    //    ${Check}{name:SugInCheck,spamExpr:"abs(sugInCount-1.29)/0.989>5.33",anomalyExpr:"abs(sugInCount-1.29)/0.989>4.5"
    //      ,outputCols:[SugInCheck],isFeatureModel=false,isJudgeModel=true,}
    //    ${Check}{name:SugShowCountMiddleCheck,spamExpr:"abs(sugShowCountmiddle-2.96)/6.53>5",anomalyExpr:"abs(sugInCount-1.29)/0.989>4.5"
    //      ,outputCols:[SugShowCountMiddleCheck],isFeatureModel=false,isJudgeModel=true,}
    //    ${Check}{name:SugShowCheck,spamExpr:"abs(sugShowCount-1.899)/2.00>5.33",anomalyExpr:"abs(sugShowCount-1.899)/2.00>4.5"
    //      ,outputCols:[SugShowCheck],isFeatureModel=false,isJudgeModel=true,}

    //    srcg
    ${FeaScoreFeatureADD}{name:secondSearchScore,expression:"SPV>200 and secondSearchCount=0",defaultscore:0.46187,inputCols:[secondSearchRate]
      ,outputCols:[secondSearchScore], isFeatureModel=true,isJudgeModel=false,}
    //orig mean=0.4729,sigma = 0.02159；在买量渠道扩大有效面，只判疑似， 阈值扩大到10
    //all_nature: sigma=0.036888136,mean=0.461872281 ,阈值改为6
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 6 改成4.5
    ${Check}{name:secondSearchRateCheck,anomalyExpr:"abs(secondSearchScore-0.46187)/0.03689>4.5",antiSpamType="DistributeDisorder"
      ,outputCols:[secondSearchRateCheck],isFeatureModel=false,isJudgeModel=true,}

    ${FeaScoreFeatureADD}{name:age0RateScore,expression:"SPV>200  and age=0",defaultscore:0.09615,inputCols:[age0Rate]
      ,outputCols:[age0RateScore], isFeatureModel=true,isJudgeModel=false,}
    //orig mean = 0.0905，sigma = 0.005；在买量渠道扩大有效面，只判疑似，
    //all_nature: mean=0.09615，sigma=0.00928
    ${Check}{name:age0RateCheck,anomalyExpr:"age0RateScore>0.80",spamExpr:"age0RateScore>0.98",antiSpamType="DistributeDisorder"
      ,outputCols:[age0RateCheck],isFeatureModel=false,isJudgeModel=true,}

    ${FeaScoreFeatureADD}{name:ADCPV2ADSPVScore,expression:"SPV>500 and adshow>0",defaultscore:0.0425,inputCols:[ADCPV2ADSPV]
      ,outputCols:[ADCPV2ADSPVScore], isFeatureModel=true,isJudgeModel=false,}
    //orig mean = 0.0309，sigma = 0.00235；在买量渠道扩大有效面，只判疑似，
    //all_nature:mean=0.0425,sigma= 0.00794 去掉点击率低的条件
    ${Check}{name:AdCtrCheck,anomalyExpr:"ADCPV2ADSPVScore>0.09",antiSpamType="DistributeDisorder"
      ,outputCols:[AdCtrCheck],isFeatureModel=false,isJudgeModel=true,}

    // 原始mean：0.83，判灰阈值0.4
    // all_nature:mean=0.854,simga = 0.0470，判灰阈值0.3
    ${FeaScoreFeatureADD}{name:CTRScore,expression:"SPV>500 and cpv=0",defaultscore:0.854,inputCols:[CPV2SPV]
      ,outputCols:[CTRScore], isFeatureModel=true,isJudgeModel=false,}
    ${Check}{name:CTRScoreCheck,anomalyExpr:"CTRScore<0.6",antiSpamType="DistributeDisorder"
      ,spamExpr:"CTRScore<0.2"
      ,channelCol:"site"
      ,remit_list:["http://www.feihuo.com"]
      ,outputCols:[CTRScoreCheck],isFeatureModel=false,isJudgeModel=true,}


    ${FeaScoreFeatureADD}{name:ADCPV2ADCUVScore,expression:"SPV>5000 and AdclickNum>0",defaultscore:1.98577,inputCols:[ADCPV2ADCUV]
      ,outputCols:[ADCPV2ADCUVScore], isFeatureModel=true,isJudgeModel=false,}
    //orig mean = 1.499，sigma =0.103；在买量渠道扩大有效面，只判疑似，阈值6，下限1.1
    //all_nature:mean=1.98577,simga=0.3596

    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 6 改成4.5
    ${Check}{name:ADCPV2ADCUVCheck,anomalyExpr:"(ADCPV2ADCUVScore-1.98577)/0.3596>4.5 or ADCPV2ADCUVScore<1.1",antiSpamType="DistributeDisorder"
      ,outputCols:[ADCPV2ADCUVCheck],isFeatureModel=false,isJudgeModel=true,}

    //orig mean = 0.17，sigma =0.00963；在买量渠道扩大有效面，只判疑似，判灰阈值0.1
    //all_nature:该特征波动很大，保持origin
    ${FeaScoreFeatureADD}{name:sugSearchRateScore,expression:" SPV>=200 and (sugInCount+sugShowCountmiddle)=0",defaultscore:0.17,inputCols:[sugSearchInfoRate]
      ,outputCols:[sugSearchRateScore], isFeatureModel=true,isJudgeModel=false,}
    ${Check}{name:sugSearchRateScoreCheck,anomalyExpr:"sugSearchRateScore<0.1",spamExpr:"sugSearchRateScore<=0.02",antiSpamType="DistributeDisorder"
      ,outputCols:[sugSearchRateScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    //   扩大阈值，可能有网吧渠道，阈值集中的情况 origin mean=0.952,sigma=0.0285,判灰阈值70
    //all_nature:mean = 0.911064 simga = 0.023125

    //0904 阈值调整为30
    ${Check}{name:SUV2IpInfoCountScoreCheck,anomalyExpr:"SUV>100 and  abs(SUV2IpInfoCount-0.911064)/0.023125>30 and isInternetBar=0"
      ,outputCols:[SUV2IpInfoCountScoreCheck],isFeatureModel=false,isJudgeModel=true,antiSpamType="DistributeDisorder"}


    // allnature mean:0.385428246748282 stddev:0.391757989025389
    ${Check}{name:actionsCountScoreCheck,anomalyExpr:"actionsCountScore>3",antiSpamType="DistributeDisorder"
      ,outputCols:[actionsCountScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 0.1 改成0.02
    ${Check}{name:ActionEntropyScoreCheck,anomalyExpr:"ActionEntropyScore>0.02",antiSpamType="DistributeDisorder"
      ,outputCols:[ActionEntropyScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    // allnature mean:0.710027212 stddev:0.21532602
    ${Check}{name:ipBinScoreCheck,anomalyExpr:"ipBinScore>=2 and isInternetBar=0",antiSpamType="DistributeDisorder"
      ,outputCols:[ipBinScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    // allnature mean:0.938564853 stddev:0.393992983
    ${Check}{name:qBinScoreCheck,anomalyExpr:"qBinScore>=4 and isInternetBar=0",antiSpamType="DistributeDisorder"
      ,outputCols:[qBinScoreCheck],isFeatureModel=false,isJudgeModel=true,}

    // all nature mean:0.461142428091482 stddev:0.372253571541655
    ${Check}{name:actionsTimeGapsScoreCheck,anomalyExpr:"actionsTimeGapsScore>=3",antiSpamType="DistributeDisorder"
      ,outputCols:[actionsTimeGapsScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    //all nature mean:0.5226096918656273 stddev:0.7029328951793096   因为数据表现波动大   6.22-6.28、7.20-7.26数据出标准
    ${Check}{name:adindustryScoreCheck,anomalyExpr:"adindustryScore>=6" ,antiSpamType="DistributeDisorder" //u114 等渠道 还是有检出 改成伯努利后白渠道是否有檢出需要再衡量
      ,outputCols:[adindustryScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    // all nature mean: 0.186785403727781 stddev:0.207438143678534
    ${Check}{name:adClickHourScoreCheck,anomalyExpr:"adClickHourScore>=3",antiSpamType="DistributeDisorder"
      ,outputCols:[adClickHourScoreCheck],isFeatureModel=false,isJudgeModel=true,}

    // all nature mean:0.406003876714904 stddev:0.757741457120878
    //linsu 0902 共现性比较好， 阈值降低 ，anomaly 由 5改成4
    ${Check}{name:posClickScoreCheck,anomalyExpr:"posClickScore>=4",antiSpamType="DistributeDisorder"
      ,outputCols:[posClickScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    //    ${Check}{name:onlineAntiSpam,anomalyExpr:"ad_cheat_type>'1'",outputCols:[onlineAntiSpam],isFeatureModel=false
    //      ,isJudgeModel=true,antiSpamType="CommercialAntiSpam"}
    //all_nature:mean = 0.9779296087981479 simga=0.009788737113211656
    ${Check}{name:ADCUV2adClickIpInfoCountScoreCheck,anomalyExpr:"ADCUV>100 and  abs(ADCUV2adClickIpInfoCount-0.9779296)/0.0097887>50 and isInternetBar=0"
      ,outputCols:[ADCUV2adClickIpInfoCountScoreCheck],isFeatureModel=false,isJudgeModel=true,
      antiSpamType="DistributeDisorder"}
    //    ${RemoveDuplicatedAdid}{isJudgeModel=true,isFeatureModel=false,timeGap=60
    //      inputCols:[guid,ad_advert_id,ad_click_id,ad_click_time,ad_click_view_gap,t],outputCols:[RemoveDuplicatedAdid]
    //      ,antiSpamType="InvalidBehavior"
    //    }


    // 计算均值时没有过滤大值 7.20-7.21
    // all_nature:mean=135.799127  138.1305835 目前的阈值对自有流量判别分别为0.00823837、10-0.00025352、20-0.00091576、30-0.00321791、40-0.0128055、50-0.02970583
    //    ${Check}{name:ADPressDurationCheck,anomalyExpr:"ad_press_duration is not null and (ad_press_duration>500 or ad_press_duration<30)",trainSource = "major"
    //      ,outputCols:[ADPressDurationCheck],isFeatureModel=false,isJudgeModel=true,antiSpamType="BusyUser"}
    // allnature mean:0.1648024179560466 stddev:0.30991808981225355  7.20-7.26数据出标准 端午数据表现一致因此未更新
//    ${Check}{name:ADClickPosScoreCheck,anomalyExpr:"ADClickPosScore>3"
//      ,outputCols:[ADClickPosScoreCheck],isFeatureModel=false,isJudgeModel=true,antiSpamType="BusyUser"}
    // allnature mean:0.133675956601221 stddev:0.21362905123809822   7.20-7.26数据出标准  端午数据表现一致因此未更新
    ${Check}{name:ADClickViewGapScoreCheck,anomalyExpr:"ADClickViewGapScore>2.5",antiSpamType="DistributeDisorder"
      ,outputCols:[ADClickViewGapScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    // allnature mean:0.16084441257020224 stddev:0.4125160202182959  阈值3      7.20-7.26数据出标准
    // allnature mean: 0.38169183799903683 stddev:0.42706162595127656   阈值改成5   因为数据表现波动大  6.22-6.28、7.20-7.26数据出标准
    //    ${Check}{name:adClickPosXScoreCheck,anomalyExpr:"adClickPosXScore>5",antiSpamType="DistributeDisorder"
    //      ,outputCols:[adClickPosXScoreCheck],isFeatureModel=false,isJudgeModel=true,}
    //    // allnature mean:0.2170395847198804 stddev:0.3617319037539915    阈值3   7.20-7.26数据出标准
    //    // allnature mean:0.6741260972733384 stddev:0.6003586041763893    阈值改成5   因为数据表现波动大   6.22-6.28、7.20-7.26数据出标准
    //    ${Check}{name:adClickPosYScoreCheck,anomalyExpr:"adClickPosYScore>5",antiSpamType="DistributeDisorder"
    //      ,outputCols:[adClickPosYScoreCheck],isFeatureModel=false,isJudgeModel=true}
    //    //all_nature: mean:1.4281839430401628 sigma:5.09073054062724    6.22-6.28、7.20-7.26数据出标准
    //    // 原始 spam>15, anomaly >10
    ${Check}{name:adUserIdmaxcountCheck,spamExpr:"adUserIdmaxcount>=22",anomalyExpr:"adUserIdmaxcount>=17",antiSpamType="BusyUser"
      ,outputCols:[adUserIdmaxcountCheck],isFeatureModel=false,isJudgeModel=true}
    //all_nature: mean:1.297483264782368 sigma:4.497509871368888    6.22-6.28、7.20-7.26数据出标准
    ${Check}{name:adAdvertIdmaxcountCheck,spamExpr:"adAdvertIdmaxcount>=20",anomalyExpr:"adAdvertIdmaxcount>=15",antiSpamType="BusyUser"
      ,outputCols:[adAdvertIdmaxcountCheck],isFeatureModel=false,isJudgeModel=true}
    //    ${IForestAddTF}{name:IForestScore,outputCols:["IForestScore"]
    //      ,isFeatureModel=true,isJudgeModel=false}
    //
    //    ${Check}{name:IForestScoreCheck,spamExpr:"IForestScore>=0.75",anomalyExpr:"IForestScore>=0.68",antiSpamType="DistributeDisorder"
    //      ,outputCols:[IForestScoreCheck],isFeatureModel=false,isJudgeModel=true}
    //
    //    ${MahaDistanceTF}{name:MahaDistanceScore,outputCols:["MahaDistanceScore"]
    //      ,isFeatureModel=true,isJudgeModel=false}
    //
    //    ${Check}{name:MahaDistanceScoreCheck,spamExpr:"MahaDistanceScore>=60",anomalyExpr:"MahaDistanceScore>=25",antiSpamType="DistributeDisorder"
    //      ,outputCols:[MahaDistanceScoreCheck],isFeatureModel=false,isJudgeModel=true}
   // ${Check}{name:IPSceneCheck,spamExpr:"ip_scene<=>'数据中心'",outputCols:[IPSceneCheck],isJudgeModel=true,antiSpamType="InvalidBehavior"}
    ${?FirstSearchHasPqCheck}{isJudgeModel=true,isFeatureModel=false,
      inputCols:[src, pq],outputCols:[FirstSearchHasPqCheck],antiSpamType="InvalidBehavior"}

    ${?StandardFormatCheck4pc}{isJudgeModel=true,isFeatureModel=false,
      inputCols:[guid,sid],outputCols:[StandardFormatCheck],antiSpamType="InvalidBehavior"
    }
    ${?DsAbnormalCheck}{
      isJudgeModel=true,isFeatureModel=false,
      inputCols:[ds],outputCols:[StandardFormatCheck],antiSpamType="InvalidBehavior"
    }
//    ${Check}{name:IPSiteCheck,anomalyExpr:"ipSiteCount>=4",antiSpamType="BusyUser"
//      ,outputCols:[IPSiteCheck],isFeatureModel=false,isJudgeModel=true}

//    ${Check}{name:ipSrcgCountCheck,anomalyExpr:"ipSrcgCount>=10",antiSpamType="BusyUser"
//      ,outputCols:[ipSrcgCountCheck],isFeatureModel=false,isJudgeModel=true}

//    ${RemoveDuplicatedRequest}{isJudgeModel=true,isFeatureModel=false,timeGap=500
//      inputCols:[guid,sid,t],outputCols:[RemoveDuplicatedRequest]
//      ,antiSpamType="InvalidBehavior"
//    }

  ]
}

//高斯分布 sigma 包含之外的比例数据
// 3sigma = 1 / 370.398 (	0.2699796%)
// 4sigma = 1 / 15787 （0.006334%）
// 4.5sigma = 1 / 147159.5358    3.4 / 1000000 (每一边)  (0.0006795346249%	)
// 5sigma = 1 / 1744278 (0.0000573303%)
// 5.326724sigma =  1 / 10000000  (0.00001%)
// 5.730729sigma = 	1 / 100000000 (0.000001%	)
// 6sigma = 1 / 506797346 (0.0000001973%)